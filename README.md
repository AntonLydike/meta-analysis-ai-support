# Classify Bibliography based on Study Relevance

This is a thin script around ollama to try and classify a bibliography file into relevant and not-so-relevant parts.

## Usage:

If you bring your own models, you need to modify the `MODELS` variable in `classify.py`. You probably also want to change the default ollama url configured.

Then, you get your bibliography file ready (make sure it is the same file used across all attempts so that results can be combined later on). Our bibliography file's sha1 is `a1a1a6d8d1f46cf1b6a9f82f30e5c0e74d81d87d`.

Then you can run the file using `python classify.py -i bibliography.txt -o llama3.jsonl -m llama3.1:8b`.

More options are:
- `-k` classify every document `k` times
- `-c` classify `c` number of documents (e.g. for a test run, only run on 10 documents by using `-c 10`)
- `--stream` output the model content as well to double check
- `--ollama-host` configure the ollama endpoint

You can resume a partial run by providing the same output file. The script will scan for the last document id processed and continue from there. This is useful for when a run got interrupted, or a computer crashed for example.


## Example Output:

The tool will produce a JSON document with the keys `score`, `reason`, `full_text`, `id`, `model` and `attempt`.

- `score` is a value between 0 and 100 describing how relevant the report is for the meta-analysis
- `reason` is a short text justifying the rating
- `full_text` is the full model output (mostly for debugging and such)
- `id` the index in the bibliography file that this response relates to
- `model` the model used
- `attempt` if `-k` is larger than 1, multiple attempts are made and the id is noted here.

```json
{"score": 85, "reason": "The study meets most of the inclusion criteria, but lacks explicit reporting of effect sizes (e.g., correlation coefficients) necessary for meta-analysis. However, it does provide sufficient statistical information to calculate effect sizes indirectly.", "full_text": "**Summary:**\n\nThe abstract describes an empirical study that explores how goal conflict in romantic relationships affects relationship quality and subjective well-being. A sample of 105 dating couples (N = 210) completed ratings on their subjective well-being, relationship quality, and the degree of goal conflict they experienced when pursuing their goals. The study used structural equation modeling to conduct dyadic analyses on the variables. The results showed that both partners' reports of higher goal conflict were associated with lower relationship quality and subjective well-being, and that one partner's report of goal conflict was indirectly related to the other partner's subjective well-being through relationship quality.\n\n**JSON Response:**\n\n```json\n{\n  \"score\": 85,\n  \"reason\": \"The study meets most of the inclusion criteria, but lacks explicit reporting of effect sizes (e.g., correlation coefficients) necessary for meta-analysis. However, it does provide sufficient statistical information to calculate effect sizes indirectly.\"\n}\n```\n\nReasoning:\n\n* The study includes human adults (mean age not specified, but implied to be a range given the context), and measures romantic relationship status (dating couples).\n* The study reports subjective well-being through validated scales (subjective well-being ratings) and assesses differences in subjective well-being across relationship status.\n* The study reports sufficient statistical information for effect size calculation indirectly (through structural equation modeling results), although explicit effect sizes are not reported.\n* The study uses a quantitative design with dyadic analyses, which aligns with the inclusion criteria.\n* The publication is written in English and a full-text article is available.\n\nHowever, the study does not explicitly report correlation coefficients or other convertible statistics necessary for meta-analysis, which would require additional steps to extract effect sizes indirectly. Nonetheless, it still meets most of the inclusion criteria, hence the moderate score (85).", "id": 791, "model": "llama3.1:8b", "attempt": 0}
{"score": 60, "reason": "The study meets some but not all criteria for inclusion. It includes measures of subjective well-being (ill-being), which is a trait-level construct, and examines the association between romantic relationship status and ill-being. However, it does not meet the criteria in several areas: (1) it focuses on specific aspects of relationships (infidelity) rather than general romantic relationship status; (2) it uses self-report measures that may be biased or influenced by individual differences in interpretation; (3) it does not report sufficient statistical information to calculate effect sizes, except for some exploratory analyses. Overall, the study's focus and design make it partially relevant to the meta-analysis.", "full_text": "**Summary:**\n\nThe study aimed to examine the role of romantic relationships in self-definition (romantic self-construal) and its implications for well-being following romantic infidelity. The researchers developed two measures of romantic self-construal, the Romantic Self-Construal Scale (RSCS) and the Partner Self-Construal Scale (PSCS), which demonstrated convergent validity. However, the results did not support the hypothesis that romantic self-construal is linked to ill-being in individuals who have experienced relationship threats. Instead, exploratory analysis suggested a potential protective effect of romantic self-construal on recovery from infidelity.\n\n**JSON Response:**\n\n```\n{\n  \"score\": 60,\n  \"reason\": \"The study meets some but not all criteria for inclusion. It includes measures of subjective well-being (ill-being), which is a trait-level construct, and examines the association between romantic relationship status and ill-being. However, it does not meet the criteria in several areas: (1) it focuses on specific aspects of relationships (infidelity) rather than general romantic relationship status; (2) it uses self-report measures that may be biased or influenced by individual differences in interpretation; (3) it does not report sufficient statistical information to calculate effect sizes, except for some exploratory analyses. Overall, the study's focus and design make it partially relevant to the meta-analysis.\"\n}\n```\n\nThe score of 60 reflects a moderate level of relevance, as the study touches on aspects related to romantic relationships and subjective well-being but does not meet the full range of criteria for inclusion.", "id": 793, "model": "llama3.1:8b", "attempt": 0}
{"score": 60, "reason": "The abstract is relevant to the meta-analysis as it examines factors that influence romantic relationships, which may indirectly impact happiness. However, the studies primarily focus on predicting positive support-willingness rather than direct measures of subjective well-being. The inclusion of relationship satisfaction and support as predictors aligns with other studies in the field, making it a somewhat suitable candidate for inclusion.", "full_text": "**Written Summary:**\n\nThe abstract describes two studies examining the predictors of positive support-willingness in romantic relationships. Study one focuses on engaged and married individuals, finding that relationship satisfaction predicts joyous support-willingness, while negative partner attributions and relationship length are significant negative predictors for engaged participants. The second study extends these findings by comparing a cognitive interdependence model to an Investment Model explanation of joyous support-willingness in a sample of married couples. Results suggest that individual-level predictors include positive support willingness, relationship satisfaction, and feeling supported by the spouse, while couple-level predictors include whether there are children in the home and sex by relationship length interactions.\n\nThe abstract does not directly measure subjective well-being as a trait-level construct, but it is relevant to the meta-analysis as it examines factors that influence relationships, which may indirectly impact happiness. However, upon closer examination, the studies appear to focus on predicting positive support-willingness rather than direct measures of happiness or life satisfaction.\n\n**JSON Response:**\n\n```\n{\n  \"score\": 60,\n  \"reason\": \"The abstract is relevant to the meta-analysis as it examines factors that influence romantic relationships, which may indirectly impact happiness. However, the studies primarily focus on predicting positive support-willingness rather than direct measures of subjective well-being. The inclusion of relationship satisfaction and support as predictors aligns with other studies in the field, making it a somewhat suitable candidate for inclusion.\"\n}\n```\n\nThe score reflects that while the abstract is related to romantic relationships and subjective well-being, its focus on predicting positive support-willingness is not directly aligned with the meta-analysis's criteria. Further investigation into the study's details would be necessary to determine its suitability for inclusion in the analysis.", "id": 794, "model": "llama3.1:8b", "attempt": 0}
{"score": 0, "reason": "The abstract does not meet any of the inclusion criteria for the meta-analysis. It is a citation analysis of philosophical interactions with formal research methods, and does not report on romantic relationship status or subjective well-being.", "full_text": "**Summary:**\n\nThe abstract provided does not appear to be relevant to the meta-analysis on how romantic relationships impact happiness. The article is actually a citation analysis of interactions between philosophy (of science) and formal research methods such as game theory and network science. It explores how philosophers have cited and applied these methods in their work, and maps the diffusion of these disciplines across various sub-areas of philosophy.\n\n**JSON Response:**\n\n```json\n{\n  \"score\": 0,\n  \"reason\": \"The abstract does not meet any of the inclusion criteria for the meta-analysis. It is a citation analysis of philosophical interactions with formal research methods, and does not report on romantic relationship status or subjective well-being.\"\n}\n```\n\nThis article would be excluded from the meta-analysis based on its irrelevance to the topic at hand.", "id": 795, "model": "llama3.1:8b", "attempt": 0}
{"score": 0, "reason": "The study does not meet the inclusion criteria for the meta-analysis on how romantic relationships impact happiness.", "full_text": "**Summary:**\n\nThe abstract discusses an exploratory qualitative study (The Elsie Study) that aims to understand the experiences of 2SLGBTQIA+ individuals who have been treated for cancer. The researchers conducted in-depth interviews with 65 participants, exploring their experiences with cancer treatment, intersectional identities and experiences, research participation decision-making, recruitment strategies, and trusted sources of information. The study found that participants from marginalized groups experienced dehumanization and emotional distress when interacting with healthcare providers who were unfamiliar with their identities. Despite not having previously participated in health research, the interviewees expressed a desire to be informed about future research opportunities.\n\n**JSON Response:**\n\n```json\n{\n  \"score\": 0,\n  \"reason\": \"The study does not meet the inclusion criteria for the meta-analysis on how romantic relationships impact happiness.\"\n}\n```\n\nThis study is not relevant to the meta-analysis because it:\n\n* Does not focus on the relationship between romantic relationship status and subjective well-being.\n* Uses a qualitative design, which does not provide the necessary statistical information for effect size calculation.\n* Measures subjective well-being as a state-level construct (e.g., emotional pain, distress) rather than a trait-level construct (e.g., life satisfaction, positive affect).\n* Is primarily focused on the experiences of 2SLGBTQIA+ individuals with cancer and their interactions with healthcare providers, rather than the impact of romantic relationships on happiness.", "id": 796, "model": "llama3.1:8b", "attempt": 0}
```